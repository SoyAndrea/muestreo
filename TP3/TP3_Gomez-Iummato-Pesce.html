<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gomez Vargas Andrea, Iummato Luciana, Pesce Andrea Gisele">

<title>TP 3 - Final Muestreo Polietápico</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TP3_Gomez-Iummato-Pesce_files/libs/clipboard/clipboard.min.js"></script>
<script src="TP3_Gomez-Iummato-Pesce_files/libs/quarto-html/quarto.js"></script>
<script src="TP3_Gomez-Iummato-Pesce_files/libs/quarto-html/popper.min.js"></script>
<script src="TP3_Gomez-Iummato-Pesce_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TP3_Gomez-Iummato-Pesce_files/libs/quarto-html/anchor.min.js"></script>
<link href="TP3_Gomez-Iummato-Pesce_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TP3_Gomez-Iummato-Pesce_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TP3_Gomez-Iummato-Pesce_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TP3_Gomez-Iummato-Pesce_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TP3_Gomez-Iummato-Pesce_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="TP3_Gomez-Iummato-Pesce_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="TP3_Gomez-Iummato-Pesce_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="TP3_Gomez-Iummato-Pesce_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#paquetes-de-trabajo" id="toc-paquetes-de-trabajo" class="nav-link active" data-scroll-target="#paquetes-de-trabajo">Paquetes de trabajo</a></li>
  <li><a href="#ejercicio-1a" id="toc-ejercicio-1a" class="nav-link" data-scroll-target="#ejercicio-1a">Ejercicio 1A</a>
  <ul class="collapse">
  <li><a href="#diseño-a---primer-etapa-de-selección" id="toc-diseño-a---primer-etapa-de-selección" class="nav-link" data-scroll-target="#diseño-a---primer-etapa-de-selección">Diseño A - Primer etapa de selección</a>
  <ul class="collapse">
  <li><a href="#asignación-de-la-muestra-por-estrato-en-forma-proporcional" id="toc-asignación-de-la-muestra-por-estrato-en-forma-proporcional" class="nav-link" data-scroll-target="#asignación-de-la-muestra-por-estrato-en-forma-proporcional">Asignación de la muestra por estrato en forma proporcional</a></li>
  <li><a href="#selección-de-circuitos-en-cada-estrato-mediante-mas" id="toc-selección-de-circuitos-en-cada-estrato-mediante-mas" class="nav-link" data-scroll-target="#selección-de-circuitos-en-cada-estrato-mediante-mas">Selección de circuitos en cada estrato mediante MAS</a></li>
  </ul></li>
  <li><a href="#diseño-a---segunda-etapa-de-selección" id="toc-diseño-a---segunda-etapa-de-selección" class="nav-link" data-scroll-target="#diseño-a---segunda-etapa-de-selección">Diseño A - Segunda etapa de selección</a>
  <ul class="collapse">
  <li><a href="#a.-cuántos-circuitos-y-mesas-electorales-hay-en-cada-estrato" id="toc-a.-cuántos-circuitos-y-mesas-electorales-hay-en-cada-estrato" class="nav-link" data-scroll-target="#a.-cuántos-circuitos-y-mesas-electorales-hay-en-cada-estrato">a. Cuántos circuitos y mesas electorales hay en cada estrato?</a></li>
  <li><a href="#b.-presentar-en-un-tabulado-el-total-de-votos-a-uxp-jxc-lla-y-fit-a-nivel-nacional-y-la-proporción-de-votos-respecto-al-total-de-votos-positivos" id="toc-b.-presentar-en-un-tabulado-el-total-de-votos-a-uxp-jxc-lla-y-fit-a-nivel-nacional-y-la-proporción-de-votos-respecto-al-total-de-votos-positivos" class="nav-link" data-scroll-target="#b.-presentar-en-un-tabulado-el-total-de-votos-a-uxp-jxc-lla-y-fit-a-nivel-nacional-y-la-proporción-de-votos-respecto-al-total-de-votos-positivos">b. Presentar en un tabulado el total de votos a UxP, JxC, LLA y FIT a nivel nacional y la proporción de votos respecto al total de votos positivos</a></li>
  <li><a href="#seleccionar-una-muestra-con-este-diseño-mas" id="toc-seleccionar-una-muestra-con-este-diseño-mas" class="nav-link" data-scroll-target="#seleccionar-una-muestra-con-este-diseño-mas">Seleccionar una muestra con este diseño (MAS)</a></li>
  <li><a href="#declarar-el-diseño-de-muestreo-a-survey-declarar-ambas-etapas-de-selección-y-con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff-en-el-caso-de-proporciones-no-es-necesario-calcular-el-deff" id="toc-declarar-el-diseño-de-muestreo-a-survey-declarar-ambas-etapas-de-selección-y-con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff-en-el-caso-de-proporciones-no-es-necesario-calcular-el-deff" class="nav-link" data-scroll-target="#declarar-el-diseño-de-muestreo-a-survey-declarar-ambas-etapas-de-selección-y-con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff-en-el-caso-de-proporciones-no-es-necesario-calcular-el-deff">Declarar el diseño de muestreo a survey (declarar ambas etapas de selección) y con survey estimar los totales y proporciones pedidas, junto a sus CV, IC(90%) y deff (en el caso de proporciones no es necesario calcular el deff)</a></li>
  <li><a href="#presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados" id="toc-presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados" class="nav-link" data-scroll-target="#presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados">Presentar en dos tablas (una para los totales , otra para las proporciones) los resultados</a></li>
  <li><a href="#los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales" id="toc-los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales" class="nav-link" data-scroll-target="#los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales">Los intervalos de confianza al 90% contienen a los parámetros poblacionales?</a></li>
  </ul></li>
  <li><a href="#diseño-b" id="toc-diseño-b" class="nav-link" data-scroll-target="#diseño-b">Diseño B</a>
  <ul class="collapse">
  <li><a href="#hay-circuitos-autorepresentados-en-algún-estrato" id="toc-hay-circuitos-autorepresentados-en-algún-estrato" class="nav-link" data-scroll-target="#hay-circuitos-autorepresentados-en-algún-estrato">Hay circuitos autorepresentados en algún estrato?</a></li>
  <li><a href="#seleccionar-una-muestra-con-este-diseño" id="toc-seleccionar-una-muestra-con-este-diseño" class="nav-link" data-scroll-target="#seleccionar-una-muestra-con-este-diseño">Seleccionar una muestra con este diseño</a></li>
  <li><a href="#declarar-el-diseño-de-muestreo-a-survey-ahora-solo-la-primera-etapa-se-declara-sin-el-fcp" id="toc-declarar-el-diseño-de-muestreo-a-survey-ahora-solo-la-primera-etapa-se-declara-sin-el-fcp" class="nav-link" data-scroll-target="#declarar-el-diseño-de-muestreo-a-survey-ahora-solo-la-primera-etapa-se-declara-sin-el-fcp">Declarar el diseño de muestreo a survey (ahora solo la primera etapa se declara, sin el fcp)</a></li>
  <li><a href="#con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff" id="toc-con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff" class="nav-link" data-scroll-target="#con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff">Con survey estimar los totales y proporciones pedidas, junto a sus CV, IC(90%) y deff</a></li>
  <li><a href="#presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados-1" id="toc-presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados-1" class="nav-link" data-scroll-target="#presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados-1">Presentar en dos tablas (una para los totales, otra para las proporciones) los resultados</a></li>
  <li><a href="#los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales-1" id="toc-los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales-1" class="nav-link" data-scroll-target="#los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales-1">Los intervalos de confianza al 90% contienen a los parámetros poblacionales?</a></li>
  <li><a href="#presentar-en-un-gráfico-de-barras-la-comparación-del-cv-estimado-de-las-estimaciones-del-total-de-votos-con-uno-y-otro-diseño.-idem-para-la-estimación-de-la-proporción-de-votos." id="toc-presentar-en-un-gráfico-de-barras-la-comparación-del-cv-estimado-de-las-estimaciones-del-total-de-votos-con-uno-y-otro-diseño.-idem-para-la-estimación-de-la-proporción-de-votos." class="nav-link" data-scroll-target="#presentar-en-un-gráfico-de-barras-la-comparación-del-cv-estimado-de-las-estimaciones-del-total-de-votos-con-uno-y-otro-diseño.-idem-para-la-estimación-de-la-proporción-de-votos.">Presentar en un gráfico de barras la comparación del CV estimado de las estimaciones del total de votos con uno y otro diseño. Idem para la estimación de la proporción de votos.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ejercicio-2-probability-vs.-nonprobability-sampling" id="toc-ejercicio-2-probability-vs.-nonprobability-sampling" class="nav-link" data-scroll-target="#ejercicio-2-probability-vs.-nonprobability-sampling">Ejercicio 2: Probability vs.&nbsp;Nonprobability Sampling</a>
  <ul class="collapse">
  <li><a href="#kiærs-representative-method-of-statistical-surveys" id="toc-kiærs-representative-method-of-statistical-surveys" class="nav-link" data-scroll-target="#kiærs-representative-method-of-statistical-surveys">Kiær’s Representative Method of Statistical Surveys</a></li>
  <li><a href="#neymans-seminal-paper" id="toc-neymans-seminal-paper" class="nav-link" data-scroll-target="#neymans-seminal-paper">Neyman’s Seminal Paper</a></li>
  <li><a href="#quota-sampling" id="toc-quota-sampling" class="nav-link" data-scroll-target="#quota-sampling">Quota Sampling</a></li>
  <li><a href="#pseudo-probability-sample-designs-for-hard-to-survey-populations" id="toc-pseudo-probability-sample-designs-for-hard-to-survey-populations" class="nav-link" data-scroll-target="#pseudo-probability-sample-designs-for-hard-to-survey-populations">Pseudo-Probability Sample Designs for “Hard-to-Survey Populations”</a></li>
  <li><a href="#internet-surveys" id="toc-internet-surveys" class="nav-link" data-scroll-target="#internet-surveys">Internet Surveys</a></li>
  <li><a href="#model-dependent-inference" id="toc-model-dependent-inference" class="nav-link" data-scroll-target="#model-dependent-inference">Model-Dependent Inference</a></li>
  <li><a href="#analytic-uses-of-survey-data" id="toc-analytic-uses-of-survey-data" class="nav-link" data-scroll-target="#analytic-uses-of-survey-data">Analytic Uses of Survey Data</a></li>
  <li><a href="#administrative-records-and-big-data" id="toc-administrative-records-and-big-data" class="nav-link" data-scroll-target="#administrative-records-and-big-data">Administrative Records and Big Data</a></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones">Conclusiones</a></li>
  </ul></li>
  <li><a href="#bibliografía" id="toc-bibliografía" class="nav-link" data-scroll-target="#bibliografía">Bibliografía</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="TP3_Gomez-Iummato-Pesce.pdf"><i class="bi bi-file-pdf"></i>Typst</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TP 3 - Final Muestreo Polietápico</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Gomez Vargas Andrea, Iummato Luciana, Pesce Andrea Gisele </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">16 de diciembre de 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="paquetes-de-trabajo" class="level1">
<h1>Paquetes de trabajo</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(binom)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stratification)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="page-break-after: always;"></div>
<p>Elegiremos avanzar con el ejericicio 1A, a realizar con la base de votos de Octubre 2023, trabajando con voto a presidente, en el cual compararemos el efecto del tamaño de muestra en cada etapa en el CV.</p>
</section>
<section id="ejercicio-1a" class="level1">
<h1>Ejercicio 1A</h1>
<p>El conjunto de mesas electorales de la elección Octubre 2023 será nuestro universo bajo estudio.</p>
<p>Se desea estimar el total de votos a Unión por la Patria, Juntos por el Cambio, La Libertad Avanza y FIT a Presidente y Vice a nivel nacional y proporción de votos respecto al total de votos positivos mediante una muestra aleatoria de mesas electorales.</p>
<p>Se compararán dos diseños, ambos bietápicos; con los circuitos electorales como Unidades de Primera Etapa (UPEs) y las mesas electorales como Unidades de Segunda Etapa (USEs).</p>
<section id="diseño-a---primer-etapa-de-selección" class="level2">
<h2 class="anchored" data-anchor-id="diseño-a---primer-etapa-de-selección">Diseño A - Primer etapa de selección</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Resultados_Octubre_2023_PRESIDENCIALES<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"Resultados_Octubre_2023_PRESIDENCIALES.csv"</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Resultados_Octubre_2023_PRESIDENCIALES)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,045,200
Columns: 23
$ año                      &lt;dbl&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…
$ eleccion_tipo            &lt;chr&gt; "GENERAL", "GENERAL", "GENERAL", "GENERAL", "…
$ recuento_tipo            &lt;chr&gt; "PROVISORIO", "PROVISORIO", "PROVISORIO", "PR…
$ padron_tipo              &lt;chr&gt; "NORMAL", "NORMAL", "NORMAL", "NORMAL", "NORM…
$ distrito_id              &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01…
$ distrito_nombre          &lt;chr&gt; "Ciudad Autónoma de Buenos Aires", "Ciudad Au…
$ seccionprovincial_id     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ seccionprovincial_nombre &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ seccion_id               &lt;chr&gt; "001", "001", "001", "001", "001", "001", "00…
$ seccion_nombre           &lt;chr&gt; "Comuna 01", "Comuna 01", "Comuna 01", "Comun…
$ circuito_id              &lt;chr&gt; "00001", "00001", "00001", "00001", "00001", …
$ circuito_nombre          &lt;chr&gt; "00001", "00001", "00001", "00001", "00001", …
$ mesa_id                  &lt;chr&gt; "00001", "00001", "00001", "00001", "00001", …
$ mesa_tipo                &lt;chr&gt; "NATIVOS", "NATIVOS", "NATIVOS", "NATIVOS", "…
$ mesa_electores           &lt;dbl&gt; 345, 345, 345, 345, 345, 345, 345, 345, 345, …
$ cargo_id                 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ cargo_nombre             &lt;chr&gt; "PRESIDENTE Y VICE", "PRESIDENTE Y VICE", "PR…
$ agrupacion_id            &lt;dbl&gt; 134, 132, 135, 136, 133, 0, 0, 0, 0, 0, 134, …
$ agrupacion_nombre        &lt;chr&gt; "UNION POR LA PATRIA", "JUNTOS POR EL CAMBIO"…
$ lista_numero             &lt;dbl&gt; NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA…
$ lista_nombre             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ votos_tipo               &lt;chr&gt; "POSITIVO", "POSITIVO", "POSITIVO", "POSITIVO…
$ votos_cantidad           &lt;dbl&gt; 96, 65, 44, 13, 4, 8, 3, 0, 0, 0, 102, 86, 38…</code></pre>
</div>
</div>
<p>Filtramos los datos para el cargo de “PRESIDENTE Y VICE” y creamos un marco de muestreo por estrato</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtramos los datos para el cargo "PRESIDENTE Y VICE"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>presidenciales <span class="ot">&lt;-</span> Resultados_Octubre_2023_PRESIDENCIALES <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cargo_nombre <span class="sc">==</span> <span class="st">"PRESIDENTE Y VICE"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Generar IDs</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>presidenciales<span class="sc">$</span>mesa_id_unico <span class="ot">=</span> <span class="fu">paste</span>(presidenciales<span class="sc">$</span>distrito_id, presidenciales<span class="sc">$</span>seccion_id, presidenciales<span class="sc">$</span>circuito_id, presidenciales<span class="sc">$</span>mesa_id)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>presidenciales<span class="sc">$</span>circuito_id_unico <span class="ot">=</span> <span class="fu">paste</span>(presidenciales<span class="sc">$</span>distrito_id, presidenciales<span class="sc">$</span>seccion_id, presidenciales<span class="sc">$</span>circuito_id)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupamos los datos por distrito para conocer el número de mesas en cada estrato</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>mesas_por_distrito <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(distrito_nombre) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mesas_totales =</span> <span class="fu">n_distinct</span>(mesa_id_unico))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>mesas_por_distrito</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 2
   distrito_nombre                 mesas_totales
   &lt;chr&gt;                                   &lt;int&gt;
 1 Buenos Aires                            38074
 2 Catamarca                                1058
 3 Chaco                                    2947
 4 Chubut                                   1416
 5 Ciudad Autónoma de Buenos Aires          7326
 6 Corrientes                               2760
 7 Córdoba                                  9097
 8 Entre Ríos                               3432
 9 Formosa                                  1484
10 Jujuy                                    1825
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Estratificamos el marco de muestreo en estas zonas:CABA, Partidos del Conurbano Bonaerense, Resto de Buenos Aires, Región Pampeana (Córdoba, Santa Fé, La Pampa, Entre Ríos), NEA - NOA, Resto</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Primero, dado que los distritos no tienen diferenciado el conurbano del resto de la Provincia, filtramos las secciones en las cuales el distrito es Buenos Aires.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtrar los datos para el distrito "Buenos Aires" y luego ver los valores únicos de seccion_nombre</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(presidenciales <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(distrito_nombre <span class="sc">==</span> <span class="st">"Buenos Aires"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">pull</span>(seccion_nombre))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Adolfo Alsina"                "Alberti"                     
  [3] "Almirante Brown"              "Avellaneda"                  
  [5] "Ayacucho"                     "Azul"                        
  [7] "Bahía Blanca"                 "Balcarce"                    
  [9] "Baradero"                     "Arrecifes"                   
 [11] "Berazategui"                  "Berisso"                     
 [13] "Bolívar"                      "Bragado"                     
 [15] "Brandsen"                     "Campana"                     
 [17] "Cañuelas"                     "Capitán Sarmiento"           
 [19] "Carlos Casares"               "Carlos Tejedor"              
 [21] "Carmen de Areco"              "Patagones"                   
 [23] "Castelli"                     "Colón"                       
 [25] "Coronel Dorrego"              "Coronel Pringles"            
 [27] "Coronel de Marina L. Rosales" "Coronel Suárez"              
 [29] "Chacabuco"                    "Chascomús"                   
 [31] "Chivilcoy"                    "Daireaux"                    
 [33] "Dolores"                      "Ensenada"                    
 [35] "Escobar"                      "Esteban Echeverría"          
 [37] "Exaltación de la Cruz"        "Florencio Varela"            
 [39] "General Alvarado"             "General Alvear"              
 [41] "General Arenales"             "General Belgrano"            
 [43] "General Guido"                "General La Madrid"           
 [45] "General Las Heras"            "General Lavalle"             
 [47] "General Juan Madariaga"       "General Paz"                 
 [49] "General Pinto"                "General Pueyrredón"          
 [51] "General Rodríguez"            "General San Martín"          
 [53] "San Miguel"                   "General Viamonte"            
 [55] "General Villegas"             "Adolfo Gonzales Chaves"      
 [57] "Guaminí"                      "Hipólito Yrigoyen"           
 [59] "Benito Juárez"                "Junín"                       
 [61] "La Matanza"                   "Lanús"                       
 [63] "La Plata"                     "Laprida"                     
 [65] "Las Flores"                   "Leandro N. Alem"             
 [67] "Lincoln"                      "Lobería"                     
 [69] "Lobos"                        "Lomas de Zamora"             
 [71] "Luján"                        "Magdalena"                   
 [73] "Maipú"                        "Mar Chiquita"                
 [75] "Marcos Paz"                   "Mercedes"                    
 [77] "Merlo"                        "Monte"                       
 [79] "Moreno"                       "Morón"                       
 [81] "Navarro"                      "Necochea"                    
 [83] "9 de Julio"                   "Olavarría"                   
 [85] "Pehuajó"                      "Pellegrini"                  
 [87] "Pergamino"                    "Pila"                        
 [89] "Pilar"                        "Pinamar"                     
 [91] "Puan"                         "Quilmes"                     
 [93] "Ramallo"                      "Rauch"                       
 [95] "Rivadavia"                    "Rojas"                       
 [97] "Roque Pérez"                  "Saavedra"                    
 [99] "Saladillo"                    "Salliqueló"                  
[101] "Salto"                        "San Andrés de Giles"         
[103] "San Antonio de Areco"         "San Cayetano"                
[105] "San Fernando"                 "San Isidro"                  
[107] "San Nicolás"                  "San Pedro"                   
[109] "San Vicente"                  "Suipacha"                    
[111] "Tandil"                       "Tapalqué"                    
[113] "Tigre"                        "Tornquist"                   
[115] "Trenque Lauquen"              "Tordillo"                    
[117] "Tres Arroyos"                 "Tres de Febrero"             
[119] "La Costa"                     "Monte Hermoso"               
[121] "25 de Mayo"                   "Vicente López"               
[123] "Villa Gesell"                 "Villarino"                   
[125] "Zárate"                       "Tres Lomas"                  
[127] "Florentino Ameghino"          "Presidente Perón"            
[129] "José C. Paz"                  "Malvinas Argentinas"         
[131] "Punta Indio"                  "Ezeiza"                      
[133] "Ituzaingó"                    "Hurlingham"                  
[135] "Lezama"                      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>conurbano_bonaerense <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"La Matanza"</span>, <span class="st">"Lomas de Zamora"</span>, <span class="st">"Quilmes"</span>, <span class="st">"Avellaneda"</span>, <span class="st">"Morón"</span>, <span class="st">"Tres de Febrero"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Lanús"</span>, <span class="st">"Almirante Brown"</span>, <span class="st">"San Fernando"</span>, <span class="st">"San Isidro"</span>, <span class="st">"San Miguel"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Florencio Varela"</span>, <span class="st">"Berazategui"</span>, <span class="st">"Hurlingham"</span>, <span class="st">"Ituzaingó"</span>, <span class="st">"Moreno"</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Merlo"</span>, <span class="st">"Tigre"</span>, <span class="st">"Varela"</span>, <span class="st">"Almirante Brown"</span>, <span class="st">"San Vicente"</span>, <span class="st">"La Plata"</span>, <span class="st">"Vicente López"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estratificación y modificación de la columna 'estrato' </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>presidenciales <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estrato =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    distrito_nombre <span class="sc">==</span> <span class="st">"Ciudad Autónoma de Buenos Aires"</span> <span class="sc">~</span> <span class="st">"CABA"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    distrito_nombre <span class="sc">==</span> <span class="st">"Buenos Aires"</span> <span class="sc">&amp;</span> seccion_nombre <span class="sc">%in%</span> conurbano_bonaerense <span class="sc">~</span> <span class="st">"Partidos del Conurbano Bonaerense"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    distrito_nombre <span class="sc">==</span> <span class="st">"Buenos Aires"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(seccion_nombre <span class="sc">%in%</span> conurbano_bonaerense) <span class="sc">~</span> <span class="st">"Resto de Buenos Aires"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    distrito_nombre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Córdoba"</span>, <span class="st">"Santa Fe"</span>, <span class="st">"La Pampa"</span>, <span class="st">"Entre Ríos"</span>) <span class="sc">~</span> <span class="st">"Región Pampeana"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    distrito_nombre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chaco"</span>, <span class="st">"Jujuy"</span>, <span class="st">"Salta"</span>, <span class="st">"Tucumán"</span>, <span class="st">"Misiones"</span>, <span class="st">"Formosa"</span>, <span class="st">"Santiago del Estero"</span>, <span class="st">"Catamarca"</span>, <span class="st">"Corrientes"</span>) <span class="sc">~</span> <span class="st">"NEA - NOA"</span>,  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Resto"</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(presidenciales<span class="sc">$</span>estrato)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                             CABA                         NEA - NOA 
                            73260                            226260 
Partidos del Conurbano Bonaerense                   Región Pampeana 
                           209090                            217630 
                            Resto             Resto de Buenos Aires 
                           147310                            171650 </code></pre>
</div>
</div>
<section id="asignación-de-la-muestra-por-estrato-en-forma-proporcional" class="level3">
<h3 class="anchored" data-anchor-id="asignación-de-la-muestra-por-estrato-en-forma-proporcional">Asignación de la muestra por estrato en forma proporcional</h3>
<p>El ejercicio indica una muestra aleatoria, estratificada, de 80 UPEs, estratificando el marco de muestreo en estas zonas: CABA, Partidos del Conurbano Bonaerense, Resto de Buenos Aires Región Pampeana (Córdoba, Santa Fé, La Pampa, Entre Ríos), NEA - NOA, Resto.</p>
<p>Para poder realizar la asignacion de la muestra debemos, calcular el total de mesas electorales en cada estrato, calcular la proporción de mesas de cada estrato sobre el total de mesas y asignar la cantidad de UPEs a cada estrato proporcionalmente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos el total de mesas por estrato</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mesas_por_estrato <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_mesas =</span> <span class="fu">n_distinct</span>(mesa_id_unico))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>mesas_por_estrato</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  estrato                           total_mesas
  &lt;chr&gt;                                   &lt;int&gt;
1 CABA                                     7326
2 NEA - NOA                               22626
3 Partidos del Conurbano Bonaerense       20909
4 Región Pampeana                         21763
5 Resto                                   14731
6 Resto de Buenos Aires                   17165</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos la proporción de mesas por estrato</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>total_mesas_totales <span class="ot">&lt;-</span> <span class="fu">sum</span>(mesas_por_estrato<span class="sc">$</span>total_mesas)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>mesas_por_estrato <span class="ot">&lt;-</span> mesas_por_estrato <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proporcion_mesas =</span> total_mesas <span class="sc">/</span> total_mesas_totales)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Asignamos el número de UPEs de manera proporcional (80 UPEs en total)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>total_UPEs <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>mesas_por_estrato <span class="ot">&lt;-</span> mesas_por_estrato <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">UPE_asignadas =</span> <span class="fu">round</span>(proporcion_mesas <span class="sc">*</span> total_UPEs))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>mesas_por_estrato</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  estrato                           total_mesas proporcion_mesas UPE_asignadas
  &lt;chr&gt;                                   &lt;int&gt;            &lt;dbl&gt;         &lt;dbl&gt;
1 CABA                                     7326           0.0701             6
2 NEA - NOA                               22626           0.216             17
3 Partidos del Conurbano Bonaerense       20909           0.200             16
4 Región Pampeana                         21763           0.208             17
5 Resto                                   14731           0.141             11
6 Resto de Buenos Aires                   17165           0.164             13</code></pre>
</div>
</div>
<p>Se asignaron 6 UPE a CABA, 17 a NEA-NOA, 16 a Partidos del Conurbano Bonaeresme, 17 a Region Pampeana, 11 a Resto y 13 a Resto de Buenos Aires.</p>
</section>
<section id="selección-de-circuitos-en-cada-estrato-mediante-mas" class="level3">
<h3 class="anchored" data-anchor-id="selección-de-circuitos-en-cada-estrato-mediante-mas">Selección de circuitos en cada estrato mediante MAS</h3>
<p>Para realizar un MAS, debemos primero filtrar los datos por estrato y seleccionar de manera aleatoria los circuitos según la cantidad de UPEs asignadas.</p>
<p>Primero agregamos la columna UPE_asignadas a la tabla presidenciales</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>presidenciales <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mesas_por_estrato <span class="sc">%&gt;%</span> <span class="fu">select</span>(estrato, UPE_asignadas), <span class="at">by =</span> <span class="st">"estrato"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(presidenciales)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,045,200
Columns: 27
$ año                      &lt;dbl&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…
$ eleccion_tipo            &lt;chr&gt; "GENERAL", "GENERAL", "GENERAL", "GENERAL", "…
$ recuento_tipo            &lt;chr&gt; "PROVISORIO", "PROVISORIO", "PROVISORIO", "PR…
$ padron_tipo              &lt;chr&gt; "NORMAL", "NORMAL", "NORMAL", "NORMAL", "NORM…
$ distrito_id              &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01…
$ distrito_nombre          &lt;chr&gt; "Ciudad Autónoma de Buenos Aires", "Ciudad Au…
$ seccionprovincial_id     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ seccionprovincial_nombre &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ seccion_id               &lt;chr&gt; "001", "001", "001", "001", "001", "001", "00…
$ seccion_nombre           &lt;chr&gt; "Comuna 01", "Comuna 01", "Comuna 01", "Comun…
$ circuito_id              &lt;chr&gt; "00001", "00001", "00001", "00001", "00001", …
$ circuito_nombre          &lt;chr&gt; "00001", "00001", "00001", "00001", "00001", …
$ mesa_id                  &lt;chr&gt; "00001", "00001", "00001", "00001", "00001", …
$ mesa_tipo                &lt;chr&gt; "NATIVOS", "NATIVOS", "NATIVOS", "NATIVOS", "…
$ mesa_electores           &lt;dbl&gt; 345, 345, 345, 345, 345, 345, 345, 345, 345, …
$ cargo_id                 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ cargo_nombre             &lt;chr&gt; "PRESIDENTE Y VICE", "PRESIDENTE Y VICE", "PR…
$ agrupacion_id            &lt;dbl&gt; 134, 132, 135, 136, 133, 0, 0, 0, 0, 0, 134, …
$ agrupacion_nombre        &lt;chr&gt; "UNION POR LA PATRIA", "JUNTOS POR EL CAMBIO"…
$ lista_numero             &lt;dbl&gt; NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA…
$ lista_nombre             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ votos_tipo               &lt;chr&gt; "POSITIVO", "POSITIVO", "POSITIVO", "POSITIVO…
$ votos_cantidad           &lt;dbl&gt; 96, 65, 44, 13, 4, 8, 3, 0, 0, 0, 102, 86, 38…
$ mesa_id_unico            &lt;chr&gt; "01 001 00001 00001", "01 001 00001 00001", "…
$ circuito_id_unico        &lt;chr&gt; "01 001 00001", "01 001 00001", "01 001 00001…
$ estrato                  &lt;chr&gt; "CABA", "CABA", "CABA", "CABA", "CABA", "CABA…
$ UPE_asignadas            &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(presidenciales<span class="sc">$</span>UPE_asignadas)  <span class="co"># Comprobar el tipo de datos de la columna UPE_asignadas</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:1045200] 6 6 6 6 6 6 6 6 6 6 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(presidenciales<span class="sc">$</span>UPE_asignadas)  <span class="co"># Verificar los primeros valores</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 6 6 6 6 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(presidenciales<span class="sc">$</span>UPE_asignadas)  <span class="co"># Ver resumen de la columna</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   6.00   13.00   16.00   14.53   17.00   17.00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(UPE_asignadas))  <span class="co"># Ver filas con UPE_asignadas NA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 27
# ℹ 27 variables: año &lt;dbl&gt;, eleccion_tipo &lt;chr&gt;, recuento_tipo &lt;chr&gt;,
#   padron_tipo &lt;chr&gt;, distrito_id &lt;chr&gt;, distrito_nombre &lt;chr&gt;,
#   seccionprovincial_id &lt;dbl&gt;, seccionprovincial_nombre &lt;chr&gt;,
#   seccion_id &lt;chr&gt;, seccion_nombre &lt;chr&gt;, circuito_id &lt;chr&gt;,
#   circuito_nombre &lt;chr&gt;, mesa_id &lt;chr&gt;, mesa_tipo &lt;chr&gt;,
#   mesa_electores &lt;dbl&gt;, cargo_id &lt;dbl&gt;, cargo_nombre &lt;chr&gt;,
#   agrupacion_id &lt;dbl&gt;, agrupacion_nombre &lt;chr&gt;, lista_numero &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Con esto sabemos que la columna UPE_asignadas es numérica, que su valor mínimo es 6, el valor máximo es 17 y no hay valores faltantes en la columna UPE_asignadas.</p>
<p>Procederemos ahora a seleccionar las UPEs de manera aleatoria en cada estrato mediante Muestreo Aleatorio Simple (MAS)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>base_mesas <span class="ot">&lt;-</span>presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato, circuito_id_unico ,mesa_id_unico ,agrupacion_nombre) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Voto =</span> <span class="fu">sum</span>(votos_cantidad,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> agrupacion_nombre,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Voto) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)  <span class="co"># Para reproducibilidad</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># total de mesas por estrato en el dataframe 'marco_circuitos'</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>marco_circuitos <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato, circuito_id_unico) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_mesas =</span> <span class="fu">n_distinct</span>(mesa_id_unico), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  columna 'UPE_asignadas' en el marco de circuitos</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>marco_circuitos_con_asignacion <span class="ot">&lt;-</span> marco_circuitos <span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(estrato) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarize</span>(<span class="at">UPE_asignadas =</span> <span class="fu">first</span>(UPE_asignadas)), <span class="at">by =</span> <span class="st">"estrato"</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora realizamos la selección de UPEs</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>marco_circuitos_con_asignacion <span class="ot">&lt;-</span> marco_circuitos_con_asignacion[<span class="fu">order</span>(marco_circuitos_con_asignacion<span class="sc">$</span>estrato),]</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>smplCircuitos <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(<span class="at">data=</span>marco_circuitos_con_asignacion, <span class="at">stratanames =</span> <span class="st">"estrato"</span>,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size=</span>mesas_por_estrato<span class="sc">$</span>UPE_asignadas,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">method=</span><span class="st">"srswor"</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>muestra_circuitos <span class="ot">&lt;-</span> <span class="fu">getdata</span>(marco_circuitos_con_asignacion, smplCircuitos)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>muestra_circuitos<span class="sc">$</span>F1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>muestra_circuitos<span class="sc">$</span>Prob</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar las primeras filas del resultado</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(muestra_circuitos))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">circuito_id_unico</th>
<th style="text-align: right;">total_mesas</th>
<th style="text-align: right;">UPE_asignadas</th>
<th style="text-align: left;">estrato</th>
<th style="text-align: right;">ID_unit</th>
<th style="text-align: right;">Prob</th>
<th style="text-align: right;">Stratum</th>
<th style="text-align: right;">F1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">28</td>
<td style="text-align: left;">01 002 00028</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.0359281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.83333</td>
</tr>
<tr class="even">
<td style="text-align: left;">80</td>
<td style="text-align: left;">01 007 00080</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">0.0359281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.83333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">101</td>
<td style="text-align: left;">01 009 00101</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.0359281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.83333</td>
</tr>
<tr class="even">
<td style="text-align: left;">111</td>
<td style="text-align: left;">01 010 00111</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">111</td>
<td style="text-align: right;">0.0359281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.83333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">137</td>
<td style="text-align: left;">01 013 00137</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">137</td>
<td style="text-align: right;">0.0359281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.83333</td>
</tr>
<tr class="even">
<td style="text-align: left;">150</td>
<td style="text-align: left;">01 014 00150</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0.0359281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.83333</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar tamaño de muestra por estrato</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(muestra_circuitos<span class="sc">$</span>estrato))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Var1</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">NEA - NOA</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Partidos del Conurbano Bonaerense</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Región Pampeana</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Resto</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resto de Buenos Aires</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="diseño-a---segunda-etapa-de-selección" class="level2">
<h2 class="anchored" data-anchor-id="diseño-a---segunda-etapa-de-selección">Diseño A - Segunda etapa de selección</h2>
<p>En cada circuito se seleccionan 12 mesas electorales mediante muestreo aleatorio simple (o todas las que haya de haber menos),</p>
<section id="a.-cuántos-circuitos-y-mesas-electorales-hay-en-cada-estrato" class="level3">
<h3 class="anchored" data-anchor-id="a.-cuántos-circuitos-y-mesas-electorales-hay-en-cada-estrato">a. Cuántos circuitos y mesas electorales hay en cada estrato?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contamos los circuitos y mesas por estrato</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>resumen_estratos <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">circuitos =</span> <span class="fu">n_distinct</span>(circuito_id_unico),  <span class="co"># Número de circuitos </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mesas_electorales =</span> <span class="fu">n_distinct</span>(mesa_id_unico)  <span class="co"># Número de mesas electorales</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_estratos, <span class="at">caption =</span> <span class="st">"Resumen de Circuitos y Mesas Electorales por Estrato"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Resumen de Circuitos y Mesas Electorales por Estrato</caption>
<thead>
<tr class="header">
<th style="text-align: left;">estrato</th>
<th style="text-align: right;">circuitos</th>
<th style="text-align: right;">mesas_electorales</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CABA</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">7326</td>
</tr>
<tr class="even">
<td style="text-align: left;">NEA - NOA</td>
<td style="text-align: right;">1783</td>
<td style="text-align: right;">22626</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Partidos del Conurbano Bonaerense</td>
<td style="text-align: right;">281</td>
<td style="text-align: right;">20909</td>
</tr>
<tr class="even">
<td style="text-align: left;">Región Pampeana</td>
<td style="text-align: right;">1562</td>
<td style="text-align: right;">21763</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Resto</td>
<td style="text-align: right;">1193</td>
<td style="text-align: right;">14731</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resto de Buenos Aires</td>
<td style="text-align: right;">766</td>
<td style="text-align: right;">17165</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="b.-presentar-en-un-tabulado-el-total-de-votos-a-uxp-jxc-lla-y-fit-a-nivel-nacional-y-la-proporción-de-votos-respecto-al-total-de-votos-positivos" class="level3">
<h3 class="anchored" data-anchor-id="b.-presentar-en-un-tabulado-el-total-de-votos-a-uxp-jxc-lla-y-fit-a-nivel-nacional-y-la-proporción-de-votos-respecto-al-total-de-votos-positivos">b. Presentar en un tabulado el total de votos a UxP, JxC, LLA y FIT a nivel nacional y la proporción de votos respecto al total de votos positivos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(presidenciales<span class="sc">$</span>agrupacion_nombre)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "UNION POR LA PATRIA"                           
[2] "JUNTOS POR EL CAMBIO"                          
[3] "LA LIBERTAD AVANZA"                            
[4] "FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD"
[5] "HACEMOS POR NUESTRO PAIS"                      
[6] NA                                              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>totalVotosPositivos <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votos_tipo <span class="sc">==</span> <span class="st">"POSITIVO"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalVotosPositivos =</span> <span class="fu">sum</span>(votos_cantidad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(totalVotosPositivos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">totalVotosPositivos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">26291718</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>votos_partido<span class="ot">&lt;-</span>presidenciales <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votos_tipo<span class="sc">==</span><span class="st">"POSITIVO"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agrupacion_nombre) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">votos_agrupacion=</span> <span class="fu">sum</span>(votos_cantidad),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">proporcion=</span> <span class="fu">round</span>(votos_agrupacion<span class="sc">/</span>totalVotosPositivos<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(votos_partido, <span class="at">caption =</span> <span class="st">"Proporción de votos por partido (valor poblacional)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Proporción de votos por partido (valor poblacional)</caption>
<colgroup>
<col style="width: 62%">
<col style="width: 22%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">agrupacion_nombre</th>
<th style="text-align: right;">votos_agrupacion</th>
<th style="text-align: left;">proporcion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</td>
<td style="text-align: right;">709932</td>
<td style="text-align: left;">2.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">HACEMOS POR NUESTRO PAIS</td>
<td style="text-align: right;">1784315</td>
<td style="text-align: left;">6.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JUNTOS POR EL CAMBIO</td>
<td style="text-align: right;">6267152</td>
<td style="text-align: left;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA LIBERTAD AVANZA</td>
<td style="text-align: right;">7884336</td>
<td style="text-align: left;">30.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UNION POR LA PATRIA</td>
<td style="text-align: right;">9645983</td>
<td style="text-align: left;">36.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="seleccionar-una-muestra-con-este-diseño-mas" class="level3">
<h3 class="anchored" data-anchor-id="seleccionar-una-muestra-con-este-diseño-mas">Seleccionar una muestra con este diseño (MAS)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculo el total de circuitos por estrato (UPE - fpc1) </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y la cantidad de mesas por circuito (USE - fpc2)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lo agrego al marco muestral total que es el df presidenciales</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>presidenciales <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fpc1 =</span> <span class="fu">n_distinct</span>(circuito_id_unico)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>presidenciales <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato,  circuito_id_unico) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fpc2 =</span> <span class="fu">n_distinct</span>(mesa_id_unico)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Genero n (UPE seleccionadas) y m (USE seleccionadas), con los tamanos de muestra en cada etapa</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">12</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#De las UPE seleccionadas (circuitos) selecciono 12 mesas por cada circuito por MAS</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>marco_mesas <span class="ot">&lt;-</span> <span class="fu">merge</span>(base_mesas, muestra_circuitos[, <span class="fu">c</span>( <span class="st">"circuito_id_unico"</span>,<span class="st">"F1"</span>)],</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by=</span> <span class="st">"circuito_id_unico"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>marco_mesas <span class="ot">&lt;-</span> <span class="fu">merge</span>(marco_mesas, presidenciales[<span class="sc">!</span><span class="fu">duplicated</span>(presidenciales<span class="sc">$</span>circuito_id_unico), <span class="fu">c</span>( <span class="st">"circuito_id_unico"</span>,<span class="st">"fpc1"</span>,<span class="st">"fpc2"</span>)],</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by=</span> <span class="st">"circuito_id_unico"</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordeno por estrato</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>marco_mesas <span class="ot">&lt;-</span> marco_mesas[<span class="fu">order</span>(marco_mesas<span class="sc">$</span>circuito_id_unico), ]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>tabla_estratos2 <span class="ot">&lt;-</span> marco_mesas <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(circuito_id_unico) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nh =</span> m,               <span class="co"># Número de unidades a seleccionar (12 por circuito)</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">fpc2 =</span> <span class="fu">n_distinct</span>(mesa_id_unico)) <span class="sc">%&gt;%</span>  <span class="co"># Cantidad de mesas por circuito (número de mesas distintas)</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nh =</span> <span class="fu">ifelse</span>(nh <span class="sc">&gt;</span> fpc2, fpc2, nh)) </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>tabla_estratos2 <span class="ot">&lt;-</span> tabla_estratos2[<span class="fu">order</span>(tabla_estratos2<span class="sc">$</span>circuito_id_unico), ]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciono muestra mesas</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>smplMesas <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(<span class="at">data=</span>marco_mesas, <span class="at">stratanames =</span> <span class="st">"circuito_id_unico"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size=</span>tabla_estratos2<span class="sc">$</span>nh,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method=</span><span class="st">"srswor"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>muestra_mesas <span class="ot">&lt;-</span> <span class="fu">getdata</span>(marco_mesas, smplMesas)        </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>muestra_mesas<span class="sc">$</span>F2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>muestra_mesas<span class="sc">$</span>Prob</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>muestra_mesas<span class="sc">$</span>pondera <span class="ot">&lt;-</span> muestra_mesas<span class="sc">$</span>F1 <span class="sc">*</span> muestra_mesas<span class="sc">$</span>F2    </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>muestra_mesas<span class="sc">$</span>TOTAL_VOTOS_POSITIVOS <span class="ot">=</span> muestra_mesas<span class="sc">$</span><span class="st">`</span><span class="at">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</span><span class="st">`</span> <span class="sc">+</span> muestra_mesas<span class="sc">$</span><span class="st">`</span><span class="at">HACEMOS POR NUESTRO PAIS</span><span class="st">`</span> <span class="sc">+</span> muestra_mesas<span class="sc">$</span><span class="st">`</span><span class="at">JUNTOS POR EL CAMBIO</span><span class="st">`</span> <span class="sc">+</span> muestra_mesas<span class="sc">$</span><span class="st">`</span><span class="at">LA LIBERTAD AVANZA</span><span class="st">`</span><span class="sc">+</span>muestra_mesas<span class="sc">$</span><span class="st">`</span><span class="at">UNION POR LA PATRIA</span><span class="st">`</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="declarar-el-diseño-de-muestreo-a-survey-declarar-ambas-etapas-de-selección-y-con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff-en-el-caso-de-proporciones-no-es-necesario-calcular-el-deff" class="level3">
<h3 class="anchored" data-anchor-id="declarar-el-diseño-de-muestreo-a-survey-declarar-ambas-etapas-de-selección-y-con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff-en-el-caso-de-proporciones-no-es-necesario-calcular-el-deff">Declarar el diseño de muestreo a survey (declarar ambas etapas de selección) y con survey estimar los totales y proporciones pedidas, junto a sus CV, IC(90%) y deff (en el caso de proporciones no es necesario calcular el deff)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaro diseño </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>circuito_id_unico <span class="sc">+</span> mesa_id_unico, <span class="at">strata=</span><span class="sc">~</span>estrato, <span class="at">weights =</span> <span class="sc">~</span>pondera, <span class="at">fpc=</span><span class="sc">~</span>fpc1<span class="sc">+</span>fpc2, <span class="at">data=</span>muestra_mesas, <span class="at">nest =</span> <span class="cn">TRUE</span>)  <span class="co"># Añadir nest=TRUE)</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#jxc</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>total_jxc <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">JUNTOS POR EL CAMBIO</span><span class="st">`</span>, diseno, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>prop_jxc <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">JUNTOS POR EL CAMBIO</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, diseno, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>total_FIT <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</span><span class="st">`</span>, diseno, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>prop_FIT <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, diseno, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">#LLA</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>total_LLA <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">LA LIBERTAD AVANZA</span><span class="st">`</span>, diseno, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>prop_LLA <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">LA LIBERTAD AVANZA</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, diseno, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">#UNION POR LA PATRIA</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>total_UxP <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">UNION POR LA PATRIA</span><span class="st">`</span>, diseno, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>prop_UxP <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">UNION POR LA PATRIA</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, diseno, <span class="at">deff=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados" class="level3">
<h3 class="anchored" data-anchor-id="presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados">Presentar en dos tablas (una para los totales , otra para las proporciones) los resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>totales_estim_disA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Agrupacion =</span> <span class="fu">c</span>(<span class="st">"JUNTOS POR EL CAMBIO"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD"</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"LA LIBERTAD AVANZA"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"UNION POR LA PATRIA"</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Total =</span> <span class="fu">c</span>(total_jxc[<span class="dv">1</span>],total_FIT[<span class="dv">1</span>],total_LLA[<span class="dv">1</span>],total_UxP[<span class="dv">1</span>]),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_li =</span> <span class="fu">c</span>(<span class="fu">confint</span>(total_jxc, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_FIT, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_LLA, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_UxP, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>]),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_ls =</span> <span class="fu">c</span>(<span class="fu">confint</span>(total_jxc, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_FIT, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_LLA, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_UxP, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>]),</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">cv</span>(total_jxc),<span class="fu">cv</span>(total_FIT),<span class="fu">cv</span>(total_LLA),<span class="fu">cv</span>(total_UxP)),</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Deff =</span> <span class="fu">c</span>(<span class="fu">deff</span>(total_jxc),<span class="fu">deff</span>(total_FIT),<span class="fu">deff</span>(total_LLA),<span class="fu">deff</span>(total_UxP)))</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(totales_estim_disA) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(totales_estim_disA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 47%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Agrupacion</th>
<th style="text-align: right;">Total</th>
<th style="text-align: right;">CI_li</th>
<th style="text-align: right;">CI_ls</th>
<th style="text-align: right;">CV</th>
<th style="text-align: right;">Deff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JUNTOS POR EL CAMBIO</td>
<td style="text-align: right;">5711100.0</td>
<td style="text-align: right;">4368860.0</td>
<td style="text-align: right;">7053340.0</td>
<td style="text-align: right;">0.1428839</td>
<td style="text-align: right;">36.32917</td>
</tr>
<tr class="even">
<td style="text-align: left;">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</td>
<td style="text-align: right;">635032.4</td>
<td style="text-align: right;">474734.2</td>
<td style="text-align: right;">795330.6</td>
<td style="text-align: right;">0.1534636</td>
<td style="text-align: right;">22.10408</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA LIBERTAD AVANZA</td>
<td style="text-align: right;">7841244.0</td>
<td style="text-align: right;">5212710.0</td>
<td style="text-align: right;">10469778.0</td>
<td style="text-align: right;">0.2037987</td>
<td style="text-align: right;">148.78316</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNION POR LA PATRIA</td>
<td style="text-align: right;">9569166.6</td>
<td style="text-align: right;">7143714.6</td>
<td style="text-align: right;">11994618.6</td>
<td style="text-align: right;">0.1540960</td>
<td style="text-align: right;">75.15467</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>props_estim_disA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Agrupacion =</span> <span class="fu">c</span>(<span class="st">"JUNTOS POR EL CAMBIO"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"LA LIBERTAD AVANZA"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"UNION POR LA PATRIA"</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">prop =</span> <span class="fu">c</span>(prop_jxc<span class="sc">$</span>ratio,prop_FIT<span class="sc">$</span>ratio,prop_LLA<span class="sc">$</span>ratio,prop_UxP<span class="sc">$</span>ratio),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_li =</span> <span class="fu">c</span>(<span class="fu">confint</span>(prop_jxc, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_FIT, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_LLA, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_UxP, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>]),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_ls =</span> <span class="fu">c</span>(<span class="fu">confint</span>(prop_jxc, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_FIT, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_LLA, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_UxP, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>]),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">cv</span>(prop_jxc),<span class="fu">cv</span>(prop_FIT),<span class="fu">cv</span>(prop_LLA),<span class="fu">cv</span>(prop_UxP)))</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(props_estim_disA) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(props_estim_disA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 54%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Agrupacion</th>
<th style="text-align: right;">prop</th>
<th style="text-align: right;">CI_li</th>
<th style="text-align: right;">CI_ls</th>
<th style="text-align: right;">CV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JUNTOS POR EL CAMBIO</td>
<td style="text-align: right;">0.2259208</td>
<td style="text-align: right;">0.1938566</td>
<td style="text-align: right;">0.2579849</td>
<td style="text-align: right;">0.0862852</td>
</tr>
<tr class="even">
<td style="text-align: left;">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</td>
<td style="text-align: right;">0.0251207</td>
<td style="text-align: right;">0.0213566</td>
<td style="text-align: right;">0.0288849</td>
<td style="text-align: right;">0.0910983</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA LIBERTAD AVANZA</td>
<td style="text-align: right;">0.3101854</td>
<td style="text-align: right;">0.2704029</td>
<td style="text-align: right;">0.3499679</td>
<td style="text-align: right;">0.0779728</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNION POR LA PATRIA</td>
<td style="text-align: right;">0.3785389</td>
<td style="text-align: right;">0.3513783</td>
<td style="text-align: right;">0.4056994</td>
<td style="text-align: right;">0.0436215</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales" class="level3">
<h3 class="anchored" data-anchor-id="los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales">Los intervalos de confianza al 90% contienen a los parámetros poblacionales?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Chequear si los IC cubren al parametro</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>totales_chequeo_disA <span class="ot">=</span> <span class="fu">merge</span>(totales_estim_disA, votos_partido[, <span class="fu">c</span>(<span class="st">"agrupacion_nombre"</span>, <span class="st">"votos_agrupacion"</span>)], <span class="at">by.x =</span> <span class="st">"Agrupacion"</span>, <span class="at">by.y =</span> <span class="st">"agrupacion_nombre"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>totales_chequeo_disA<span class="sc">$</span>Cubre_param <span class="ot">=</span> totales_chequeo_disA<span class="sc">$</span>CI_li <span class="sc">&lt;=</span> totales_chequeo_disA<span class="sc">$</span>votos_agrupacion <span class="sc">&amp;</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                                            totales_chequeo_disA<span class="sc">$</span>CI_ls <span class="sc">&gt;=</span> totales_chequeo_disA<span class="sc">$</span>votos_agrupacion</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>totales_chequeo_disA[, <span class="fu">c</span>(<span class="st">"Agrupacion"</span>,<span class="st">"Cubre_param"</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Agrupacion Cubre_param
1 FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD        TRUE
2                           JUNTOS POR EL CAMBIO        TRUE
3                             LA LIBERTAD AVANZA        TRUE
4                            UNION POR LA PATRIA        TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>props_chequeo_disA <span class="ot">=</span> <span class="fu">merge</span>(props_estim_disA, votos_partido[, <span class="fu">c</span>(<span class="st">"agrupacion_nombre"</span>, <span class="st">"proporcion"</span>)], <span class="at">by.x =</span> <span class="st">"Agrupacion"</span>, <span class="at">by.y =</span> <span class="st">"agrupacion_nombre"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>props_chequeo_disA<span class="sc">$</span>Cubre_param <span class="ot">=</span> props_chequeo_disA<span class="sc">$</span>CI_li <span class="sc">&lt;=</span> props_chequeo_disA<span class="sc">$</span>proporcion <span class="sc">&amp;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                                            props_chequeo_disA<span class="sc">$</span>CI_ls <span class="sc">&gt;=</span> props_chequeo_disA<span class="sc">$</span>proporcion</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>props_chequeo_disA[, <span class="fu">c</span>(<span class="st">"Agrupacion"</span> ,<span class="st">"Cubre_param"</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Agrupacion totalVotosPositivos
1 FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD               FALSE
2                           JUNTOS POR EL CAMBIO               FALSE
3                             LA LIBERTAD AVANZA               FALSE
4                            UNION POR LA PATRIA               FALSE</code></pre>
</div>
</div>
<p>Los intervalos de confianza contienen a los parámetros poblacionales en todos los casos En cuanto a las diferencias entre los partidos puede afirmarse con un 90% de confianza que las proporciones de votos para cada partido difieren entre sí, es decir que Unión por la Patria es el partido con mayor porcentaje de votos, seguido por la libertad avanza, luego juntos por el cambio y finalmente el FIT, dado que los intervalos de confianza para estos valores no se solapan.En cambio al observar los totales, los intervalos de confianza de los 3 partidos con más votos sí se solapan y también se observa que los coeficientes de variación son mayors (aunque sólo el de LLA supera ligeramente el 20%).</p>
</section>
</section>
<section id="diseño-b" class="level2">
<h2 class="anchored" data-anchor-id="diseño-b">Diseño B</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos el total de mesas por estrato</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mesas_por_circuito <span class="ot">&lt;-</span> presidenciales <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(estrato, circuito_id_unico) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_mesas_circuito =</span> <span class="fu">n_distinct</span>(mesa_id_unico))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>mesas_por_circuito <span class="ot">&lt;-</span> <span class="fu">merge</span>(mesas_por_circuito, presidenciales[<span class="sc">!</span><span class="fu">duplicated</span>(presidenciales<span class="sc">$</span>circuito_id_unico), <span class="fu">c</span>( <span class="st">"circuito_id_unico"</span>,<span class="st">"UPE_asignadas"</span>, <span class="st">"distrito_id"</span>, <span class="st">"seccion_id"</span>, <span class="st">"circuito_id"</span>)], <span class="at">by=</span> <span class="st">"circuito_id_unico"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>mesas_por_circuito <span class="ot">&lt;-</span> <span class="fu">merge</span>(mesas_por_circuito, mesas_por_estrato[, <span class="fu">c</span>(<span class="st">"estrato"</span>, <span class="st">"total_mesas"</span>)], <span class="at">by =</span> <span class="st">"estrato"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Genero probabilidad de seleccion</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>mesas_por_circuito<span class="sc">$</span>pik <span class="ot">&lt;-</span> mesas_por_circuito<span class="sc">$</span>UPE_asignadas <span class="sc">*</span> mesas_por_circuito<span class="sc">$</span>total_mesas_circuito <span class="sc">/</span> mesas_por_circuito<span class="sc">$</span>total_mesas </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mesas_por_circuito<span class="sc">$</span>pik)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.325984</code></pre>
</div>
</div>
<section id="hay-circuitos-autorepresentados-en-algún-estrato" class="level3">
<h3 class="anchored" data-anchor-id="hay-circuitos-autorepresentados-en-algún-estrato">Hay circuitos autorepresentados en algún estrato?</h3>
<p>No hay ningún circuito con probabilidad uno en ningún estrato</p>
</section>
<section id="seleccionar-una-muestra-con-este-diseño" class="level3">
<h3 class="anchored" data-anchor-id="seleccionar-una-muestra-con-este-diseño">Seleccionar una muestra con este diseño</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ordeno el marco</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>mesas_por_circuito <span class="ot">&lt;-</span> mesas_por_circuito[<span class="fu">order</span>(mesas_por_circuito<span class="sc">$</span>estrato, mesas_por_circuito<span class="sc">$</span>distrito_id, mesas_por_circuito<span class="sc">$</span>seccion_id, mesas_por_circuito<span class="sc">$</span>circuito_id),]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>smplCircuitosB <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(<span class="at">data=</span>mesas_por_circuito, <span class="at">stratanames =</span> <span class="st">"estrato"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span>mesas_por_circuito<span class="sc">$</span>UPE_asignadas[<span class="sc">!</span><span class="fu">duplicated</span>(mesas_por_circuito<span class="sc">$</span>estrato)],</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">pik=</span>mesas_por_circuito<span class="sc">$</span>pik,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method=</span><span class="st">"systematic"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>muestra_circuitosB <span class="ot">&lt;-</span> <span class="fu">getdata</span>(mesas_por_circuito, smplCircuitosB)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>muestra_circuitosB<span class="sc">$</span>F1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>muestra_circuitosB<span class="sc">$</span>Prob</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar las primeras filas del resultado</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(muestra_circuitosB)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    circuito_id_unico total_mesas_circuito UPE_asignadas distrito_id seccion_id
28       01 002 00028                   50             6          01        002
63       01 005 00063                   56             6          01        005
87       01 008 00087                   97             6          01        008
111      01 010 00111                   33             6          01        010
137      01 013 00137                   40             6          01        013
160      01 015 00160                   66             6          01        015
    circuito_id total_mesas        pik estrato ID_unit       Prob Stratum
28        00028        7326 0.04095004    CABA      28 0.04095004       1
63        00063        7326 0.04586405    CABA      63 0.04586405       1
87        00087        7326 0.07944308    CABA      87 0.07944308       1
111       00111        7326 0.02702703    CABA     111 0.02702703       1
137       00137        7326 0.03276003    CABA     137 0.03276003       1
160       00160        7326 0.05405405    CABA     160 0.05405405       1
          F1
28  24.42000
63  21.80357
87  12.58763
111 37.00000
137 30.52500
160 18.50000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar tamaño de muestra por estrato</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(muestra_circuitosB<span class="sc">$</span>estrato)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                             CABA                         NEA - NOA 
                                6                                17 
Partidos del Conurbano Bonaerense                   Región Pampeana 
                               16                                17 
                            Resto             Resto de Buenos Aires 
                               11                                13 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#De las UPE seleccionadas (circuitos) selecciono 12 mesas por cada circuito por MAS</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>marco_mesasB <span class="ot">&lt;-</span> <span class="fu">merge</span>(base_mesas, muestra_circuitosB[, <span class="fu">c</span>( <span class="st">"circuito_id_unico"</span>,<span class="st">"F1"</span>)],</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by=</span> <span class="st">"circuito_id_unico"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>marco_mesasB <span class="ot">&lt;-</span> marco_mesasB[<span class="fu">order</span>(marco_mesasB<span class="sc">$</span>circuito_id_unico), ]</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>tabla_estratos_disB <span class="ot">&lt;-</span> marco_mesasB <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(circuito_id_unico) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nh =</span> m,               <span class="co"># Número de unidades a seleccionar (12 por circuito)</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">fpc2 =</span> <span class="fu">n_distinct</span>(mesa_id_unico)) <span class="sc">%&gt;%</span>  <span class="co"># Cantidad de mesas por circuito (número de mesas distintas)</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nh =</span> <span class="fu">ifelse</span>(nh <span class="sc">&gt;</span> fpc2, fpc2, nh)) </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>tabla_estratos_disB <span class="ot">&lt;-</span> tabla_estratos_disB[<span class="fu">order</span>(tabla_estratos_disB<span class="sc">$</span>circuito_id_unico), ]</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciono muestra mesas</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>smplMesasB <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">strata</span>(<span class="at">data=</span>marco_mesasB, <span class="at">stratanames =</span> <span class="st">"circuito_id_unico"</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size=</span>tabla_estratos_disB<span class="sc">$</span>nh,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method=</span><span class="st">"srswor"</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>muestra_mesasB <span class="ot">&lt;-</span> <span class="fu">getdata</span>(marco_mesasB, smplMesasB)        </span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>muestra_mesasB<span class="sc">$</span>F2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>muestra_mesasB<span class="sc">$</span>Prob</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>muestra_mesasB<span class="sc">$</span>pondera <span class="ot">&lt;-</span> muestra_mesasB<span class="sc">$</span>F1 <span class="sc">*</span> muestra_mesasB<span class="sc">$</span>F2    </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>muestra_mesasB<span class="sc">$</span>TOTAL_VOTOS_POSITIVOS <span class="ot">=</span> muestra_mesasB<span class="sc">$</span><span class="st">`</span><span class="at">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</span><span class="st">`</span> <span class="sc">+</span> muestra_mesasB<span class="sc">$</span><span class="st">`</span><span class="at">HACEMOS POR NUESTRO PAIS</span><span class="st">`</span> <span class="sc">+</span> muestra_mesasB<span class="sc">$</span><span class="st">`</span><span class="at">JUNTOS POR EL CAMBIO</span><span class="st">`</span> <span class="sc">+</span> muestra_mesasB<span class="sc">$</span><span class="st">`</span><span class="at">LA LIBERTAD AVANZA</span><span class="st">`</span><span class="sc">+</span>muestra_mesasB<span class="sc">$</span><span class="st">`</span><span class="at">UNION POR LA PATRIA</span><span class="st">`</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="declarar-el-diseño-de-muestreo-a-survey-ahora-solo-la-primera-etapa-se-declara-sin-el-fcp" class="level3">
<h3 class="anchored" data-anchor-id="declarar-el-diseño-de-muestreo-a-survey-ahora-solo-la-primera-etapa-se-declara-sin-el-fcp">Declarar el diseño de muestreo a survey (ahora solo la primera etapa se declara, sin el fcp)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaro diseño </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>disenoB <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span>circuito_id_unico , <span class="at">strata=</span><span class="sc">~</span>estrato, <span class="at">weights =</span> <span class="sc">~</span>pondera, <span class="at">data=</span>muestra_mesasB)  <span class="co"># Añadir nest=TRUE)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff" class="level3">
<h3 class="anchored" data-anchor-id="con-survey-estimar-los-totales-y-proporciones-pedidas-junto-a-sus-cv-ic90-y-deff">Con survey estimar los totales y proporciones pedidas, junto a sus CV, IC(90%) y deff</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#jxc</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>total_jxc_B <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">JUNTOS POR EL CAMBIO</span><span class="st">`</span>, disenoB, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>prop_jxc_B <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">JUNTOS POR EL CAMBIO</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, disenoB, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#FIT</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>total_FIT_B <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</span><span class="st">`</span>, disenoB, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>prop_FIT_B <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, disenoB, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#LLA</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>total_LLA_B <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">LA LIBERTAD AVANZA</span><span class="st">`</span>, disenoB, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>prop_LLA_B <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">LA LIBERTAD AVANZA</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, disenoB, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#UNION POR LA PATRIA</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>total_UxP_B <span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span><span class="st">`</span><span class="at">UNION POR LA PATRIA</span><span class="st">`</span>, disenoB, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">cv=</span><span class="cn">TRUE</span>, <span class="at">deff=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>prop_UxP_B <span class="ot">&lt;-</span> <span class="fu">svyratio</span>(<span class="at">numerator =</span> <span class="sc">~</span><span class="st">`</span><span class="at">UNION POR LA PATRIA</span><span class="st">`</span>, <span class="at">denominator =</span> <span class="sc">~</span>TOTAL_VOTOS_POSITIVOS, disenoB, <span class="at">deff=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados-1" class="level3">
<h3 class="anchored" data-anchor-id="presentar-en-dos-tablas-una-para-los-totales-otra-para-las-proporciones-los-resultados-1">Presentar en dos tablas (una para los totales, otra para las proporciones) los resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>totales_estim_disB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Agrupacion =</span> <span class="fu">c</span>(<span class="st">"JUNTOS POR EL CAMBIO"</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD"</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"LA LIBERTAD AVANZA"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"UNION POR LA PATRIA"</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Total =</span> <span class="fu">c</span>(total_jxc_B[<span class="dv">1</span>],total_FIT_B[<span class="dv">1</span>],total_LLA_B[<span class="dv">1</span>],total_UxP_B[<span class="dv">1</span>]),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_li =</span> <span class="fu">c</span>(<span class="fu">confint</span>(total_jxc_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_FIT_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_LLA_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_UxP_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>]),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_ls =</span> <span class="fu">c</span>(<span class="fu">confint</span>(total_jxc_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_FIT_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_LLA_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(total_UxP_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>]),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">cv</span>(total_jxc_B),<span class="fu">cv</span>(total_FIT_B),<span class="fu">cv</span>(total_LLA_B),<span class="fu">cv</span>(total_UxP_B)),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Deff =</span> <span class="fu">c</span>(<span class="fu">deff</span>(total_jxc_B),<span class="fu">deff</span>(total_FIT_B),<span class="fu">deff</span>(total_LLA_B),<span class="fu">deff</span>(total_UxP_B)))</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(totales_estim_disB) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(totales_estim_disB)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 48%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Agrupacion</th>
<th style="text-align: right;">Total</th>
<th style="text-align: right;">CI_li</th>
<th style="text-align: right;">CI_ls</th>
<th style="text-align: right;">CV</th>
<th style="text-align: right;">Deff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JUNTOS POR EL CAMBIO</td>
<td style="text-align: right;">6209221.2</td>
<td style="text-align: right;">5728949.6</td>
<td style="text-align: right;">6689492.9</td>
<td style="text-align: right;">0.0470243</td>
<td style="text-align: right;">7.799828</td>
</tr>
<tr class="even">
<td style="text-align: left;">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</td>
<td style="text-align: right;">698304.9</td>
<td style="text-align: right;">647803.4</td>
<td style="text-align: right;">748806.4</td>
<td style="text-align: right;">0.0439675</td>
<td style="text-align: right;">3.436188</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA LIBERTAD AVANZA</td>
<td style="text-align: right;">8045818.2</td>
<td style="text-align: right;">7678125.4</td>
<td style="text-align: right;">8413511.0</td>
<td style="text-align: right;">0.0277835</td>
<td style="text-align: right;">5.775325</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNION POR LA PATRIA</td>
<td style="text-align: right;">9672573.6</td>
<td style="text-align: right;">9031129.1</td>
<td style="text-align: right;">10314018.0</td>
<td style="text-align: right;">0.0403171</td>
<td style="text-align: right;">6.773330</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>props_estim_disB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Agrupacion =</span> <span class="fu">c</span>(<span class="st">"JUNTOS POR EL CAMBIO"</span>,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD"</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"LA LIBERTAD AVANZA"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"UNION POR LA PATRIA"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">prop =</span> <span class="fu">c</span>(prop_jxc_B<span class="sc">$</span>ratio,prop_FIT_B<span class="sc">$</span>ratio,prop_LLA_B<span class="sc">$</span>ratio,prop_UxP_B<span class="sc">$</span>ratio),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_li =</span> <span class="fu">c</span>(<span class="fu">confint</span>(prop_jxc_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_FIT_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_LLA_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>],</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_UxP_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">1</span>]),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CI_ls =</span> <span class="fu">c</span>(<span class="fu">confint</span>(prop_jxc_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_FIT_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_LLA_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>],</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">confint</span>(prop_UxP_B, <span class="at">level =</span> <span class="fl">0.9</span>)[<span class="dv">2</span>]),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">cv</span>(prop_jxc_B),<span class="fu">cv</span>(prop_FIT_B),<span class="fu">cv</span>(prop_LLA_B),<span class="fu">cv</span>(prop_UxP_B)))</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(props_estim_disB) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(props_estim_disB)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 54%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Agrupacion</th>
<th style="text-align: right;">prop</th>
<th style="text-align: right;">CI_li</th>
<th style="text-align: right;">CI_ls</th>
<th style="text-align: right;">CV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JUNTOS POR EL CAMBIO</td>
<td style="text-align: right;">0.2353029</td>
<td style="text-align: right;">0.2173614</td>
<td style="text-align: right;">0.2532444</td>
<td style="text-align: right;">0.0463558</td>
</tr>
<tr class="even">
<td style="text-align: left;">FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD</td>
<td style="text-align: right;">0.0264628</td>
<td style="text-align: right;">0.0246157</td>
<td style="text-align: right;">0.0283098</td>
<td style="text-align: right;">0.0424345</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA LIBERTAD AVANZA</td>
<td style="text-align: right;">0.3049021</td>
<td style="text-align: right;">0.2931784</td>
<td style="text-align: right;">0.3166257</td>
<td style="text-align: right;">0.0233762</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNION POR LA PATRIA</td>
<td style="text-align: right;">0.3665491</td>
<td style="text-align: right;">0.3424258</td>
<td style="text-align: right;">0.3906724</td>
<td style="text-align: right;">0.0400108</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales-1" class="level3">
<h3 class="anchored" data-anchor-id="los-intervalos-de-confianza-al-90-contienen-a-los-parámetros-poblacionales-1">Los intervalos de confianza al 90% contienen a los parámetros poblacionales?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Chequear si los IC cubren al parametro</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>totales_chequeo_disB <span class="ot">=</span> <span class="fu">merge</span>(totales_estim_disB, votos_partido[, <span class="fu">c</span>(<span class="st">"agrupacion_nombre"</span>, <span class="st">"votos_agrupacion"</span>)], <span class="at">by.x =</span> <span class="st">"Agrupacion"</span>, <span class="at">by.y =</span> <span class="st">"agrupacion_nombre"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>totales_chequeo_disB<span class="sc">$</span>Cubre_param <span class="ot">=</span> totales_chequeo_disB<span class="sc">$</span>CI_li <span class="sc">&lt;=</span> totales_chequeo_disB<span class="sc">$</span>votos_agrupacion <span class="sc">&amp;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                            totales_chequeo_disB<span class="sc">$</span>CI_ls <span class="sc">&gt;=</span> totales_chequeo_disB<span class="sc">$</span>votos_agrupacion</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>totales_chequeo_disB[, <span class="fu">c</span>(<span class="st">"Agrupacion"</span>,<span class="st">"Cubre_param"</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Agrupacion Cubre_param
1 FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD        TRUE
2                           JUNTOS POR EL CAMBIO        TRUE
3                             LA LIBERTAD AVANZA        TRUE
4                            UNION POR LA PATRIA        TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>props_chequeo_disB <span class="ot">=</span> <span class="fu">merge</span>(props_estim_disB, votos_partido[, <span class="fu">c</span>(<span class="st">"agrupacion_nombre"</span>, <span class="st">"proporcion"</span>)], <span class="at">by.x =</span> <span class="st">"Agrupacion"</span>, <span class="at">by.y =</span> <span class="st">"agrupacion_nombre"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>props_chequeo_disB<span class="sc">$</span>Cubre_param <span class="ot">=</span> props_chequeo_disB<span class="sc">$</span>CI_li <span class="sc">&lt;=</span> props_chequeo_disB<span class="sc">$</span>proporcion <span class="sc">&amp;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                                            props_chequeo_disB<span class="sc">$</span>CI_ls <span class="sc">&gt;=</span> props_chequeo_disB<span class="sc">$</span>proporcion</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>props_chequeo_disB[, <span class="fu">c</span>(<span class="st">"Agrupacion"</span> ,<span class="st">"Cubre_param"</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Agrupacion totalVotosPositivos
1 FRENTE DE IZQUIERDA Y DE TRABAJADORES - UNIDAD               FALSE
2                           JUNTOS POR EL CAMBIO               FALSE
3                             LA LIBERTAD AVANZA               FALSE
4                            UNION POR LA PATRIA               FALSE</code></pre>
</div>
</div>
<p>Los intervalos de confianza contienen a los parámetros poblacionales en todos los casos. Al observar los IC de las proporciones estimadas vemos que no se solapan sus límites inferiores y superiores por lo que puede afirmarse que las estimaciones difieren entre sí pudiendo indicar los partidos con mayor y menor porcentaje de votos con un 90% de confianza. En el caso de los totales, a diferencia del diseño A tampoco se solapan los IC, pudiendo afirmarse en este punto también que las estimaciones de los votos son diferentes para cada partido, siendo que el que más votos obtuvo fue UXP, seguido de LLA, JxC y finalmente FIT. Los coeficientes de variación son menores en este diseño, y en cuando al DEFF de la estimación de los totales, es mucho mayor para el diseño A que para el diseño B, lo que implica que la varianza de las estimaciones es mayor.</p>
</section>
<section id="presentar-en-un-gráfico-de-barras-la-comparación-del-cv-estimado-de-las-estimaciones-del-total-de-votos-con-uno-y-otro-diseño.-idem-para-la-estimación-de-la-proporción-de-votos." class="level3">
<h3 class="anchored" data-anchor-id="presentar-en-un-gráfico-de-barras-la-comparación-del-cv-estimado-de-las-estimaciones-del-total-de-votos-con-uno-y-otro-diseño.-idem-para-la-estimación-de-la-proporción-de-votos.">Presentar en un gráfico de barras la comparación del CV estimado de las estimaciones del total de votos con uno y otro diseño. Idem para la estimación de la proporción de votos.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graficos totales </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de los partidos</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>partidos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JxC"</span>, <span class="st">"FIT"</span>, <span class="st">"LLA"</span>, <span class="st">"UxP"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de barras</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">barplot</span>(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rbind</span>(totales_estim_disA<span class="sc">$</span>CV<span class="sc">*</span><span class="dv">100</span>, totales_estim_disB<span class="sc">$</span>CV<span class="sc">*</span><span class="dv">100</span>), <span class="co"># Combinar los CV en una matriz</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="co"># Barras lado a lado</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> partidos, <span class="co"># Nombres de los partidos en el eje X</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#26547c"</span>, <span class="st">"#ef476f"</span>), <span class="co"># Colores para los diseños</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Comparación de CV entre diseños muestrales </span><span class="sc">\n</span><span class="st">- TOTALES"</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Partidos"</span>, <span class="co"># Etiqueta del eje X</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Coeficiente de Variación (%)"</span> <span class="co"># Etiqueta del eje Y</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Diseño A"</span>, <span class="st">"Diseño B"</span>),</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#26547c"</span>, <span class="st">"#ef476f"</span>),</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex=</span><span class="fl">0.6</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="dv">0</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_Gomez-Iummato-Pesce_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gráfico PROPORCIONES</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de los partidos</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>partidos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JxC"</span>, <span class="st">"FIT"</span>, <span class="st">"LLA"</span>, <span class="st">"UxP"</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de barras</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">barplot</span>(</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rbind</span>(props_estim_disA<span class="sc">$</span>CV<span class="sc">*</span><span class="dv">100</span>, props_estim_disB<span class="sc">$</span>CV<span class="sc">*</span><span class="dv">100</span>), <span class="co"># Combinar los CV en una matriz</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="co"># Barras lado a lado</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> partidos, <span class="co"># Nombres de los partidos en el eje X</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#26547c"</span>, <span class="st">"#ef476f"</span>), <span class="co"># Colores para los diseños A y B</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Comparación de CV entre diseños muestrales </span><span class="sc">\n</span><span class="st">- PROPORCIONES"</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Partidos"</span>, <span class="co"># Etiqueta del eje X</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Coeficiente de Variación (%)"</span> <span class="co"># Etiqueta del eje Y</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Diseño A"</span>, <span class="st">"Diseño B"</span>),</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#26547c"</span>, <span class="st">"#ef476f"</span>),</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex=</span><span class="fl">0.6</span>,</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="dv">0</span>)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_Gomez-Iummato-Pesce_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los CV de las estimaciones de las proporciones de votos por partido son menores que las estimaciones del total de votos. El diseño A presenta mayores CV para ambos tipos de estimaciones pero la brecha respecto del diseño B es mayor en los totales que en las proporciones.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="ejercicio-2-probability-vs.-nonprobability-sampling" class="level1">
<h1>Ejercicio 2: Probability vs.&nbsp;Nonprobability Sampling</h1>
<p><em>Palabras clave: muestreo representativo, muestreo por cuotas, poblaciones difíciles de encuestar, inferencia dependiente del modelo, encuestas por Internet, big data, registros administrativos.</em></p>
<p>Este trabajo presenta una selección de los principales desarrollos en la investigación sobre encuestas desde su introducción a finales del siglo XIX, centrándose en las encuestas de hogares y personas, con énfasis en los métodos de muestreo utilizados. Aunque se han producido avances significativos en otras áreas, como los modos de recolección de datos y el diseño de cuestionarios, estos temas quedan fuera del alcance del análisis.</p>
<p><em>Figura 1. Mapa conceptual</em></p>
<div class="cell" data-fig-width="6.5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR 
  A(Estadísticas Sociales) --&gt; B(Encuestas a hogares y personas)
  B --&gt; C{{Métodos de muestreo}}
  C --&gt; D[Probabilísticos]
  C --&gt; E[No probabilísticos]
  E --&gt; F[Muestreo por cuotas]
  E --&gt; G[Muestreo bola de nieve]
  E --&gt; H[Muestreo por conveniencia]
  D --&gt; I[Muestreo aleatorio simple]
  D --&gt; J[Muestreo sistemático]
  D --&gt; K[Muestreo estratificado]
  D --&gt; L[Muestreo por conglomerado]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<section id="kiærs-representative-method-of-statistical-surveys" class="level2">
<h2 class="anchored" data-anchor-id="kiærs-representative-method-of-statistical-surveys">Kiær’s Representative Method of Statistical Surveys</h2>
<p>El método representativo de Kiær, desarrollado en 1897, fue pionero en el diseño de encuestas estadísticas a gran escala en Noruega, utilizando un muestreo por áreas en dos etapas para garantizar la representatividad. Este enfoque buscaba reflejar un microcosmos de la población mediante criterios basados en el censo de 1891, seleccionando distritos administrativos y personas dentro de ellos. Sin embargo, su trabajo enfrentó fuertes críticas en reuniones del International Statistical Institute (ISI) y en Noruega, donde su diseño fue cuestionado por no ser verdaderamente representativo y por errores en la estimación de ciertas variables clave. La controversia, especialmente en torno a un proyecto de ley sobre seguridad social, llevó al abandono del método representativo en Noruega.</p>
<p>Tras décadas de debate, el muestreo representativo volvió a ganar aceptación en el ISI en 1924, cuando se reconoció la validez de las “investigaciones parciales”. Un informe de 1926 concluyó que las muestras eran aceptables si eran suficientemente representativas, ya fuera mediante selección aleatoria o intencional. Este cambio marcó un avance hacia los métodos de muestreo que conocemos hoy, integrando principios de representatividad estadística en la investigación.</p>
</section>
<section id="neymans-seminal-paper" class="level2">
<h2 class="anchored" data-anchor-id="neymans-seminal-paper">Neyman’s Seminal Paper</h2>
<p>En 1934, Neyman presentó un artículo en el que comparaba los métodos de selección aleatoria y selectiva, lo que marcó un hito en el muestreo estadístico. En su trabajo, discutió cómo se pueden realizar inferencias a partir de muestras probabilísticas de poblaciones finitas y definió el intervalo de confianza en este contexto. También criticó las limitaciones del muestreo selectivo, señalando que, en muchos casos, no representaba adecuadamente a la población, como ocurrió con el estudio realizado por Gini y Galvani sobre el Censo General Italiano. Su trabajo promovió la adopción generalizada del muestreo probabilístico, especialmente por parte de las oficinas estadísticas nacionales, y sentó las bases para el desarrollo de muchos métodos y teorías de muestreo en las décadas siguientes.</p>
<p>Sin embargo, para aplicar el diseño de muestreo ideal de Neyman, es necesario cumplir con ciertas condiciones, como disponer de un marco de muestreo completo, probabilidades de selección conocidas y respuestas precisas de los encuestados. A pesar de estas condiciones ideales, en la práctica surgen problemas como la no cobertura (cuando algunos elementos de la población no se incluyen en el marco de muestreo) y la no respuesta (cuando los individuos seleccionados no responden). Estos problemas pueden introducir errores en las estimaciones obtenidas a partir de las muestras.</p>
<p>A pesar de la robustez del muestreo probabilístico, este tiene desventajas, como los altos costos y los plazos más largos para la recolección de datos. Para hacer frente a estos desafíos, se han desarrollado métodos menos rigurosos, conocidos como “pseudo-probabilísticos”, que intentan aplicar un enfoque de muestreo probabilístico pero dependen de suposiciones de modelado. Métodos como el muestreo por cuotas, ampliamente utilizado en la investigación de mercados, son ejemplos de estas técnicas, que aunque no son muestreo probabilístico, buscan aproximarse a sus resultados.</p>
</section>
<section id="quota-sampling" class="level2">
<h2 class="anchored" data-anchor-id="quota-sampling">Quota Sampling</h2>
<p>En 1936, el sondeo de la revista Literary Digest para predecir las elecciones presidenciales de Estados Unidos resultó en un claro sesgo debido a la muestra utilizada. Al seleccionar a los participantes de directorios telefónicos, propietarios de automóviles y votantes registrados, se excluyó a sectores más pobres de la población, lo que favoreció a los votantes de clases altas. Aunque el tamaño de la muestra fue grande (10 millones de personas), la falta de ajuste de ponderaciones resultó en una predicción incorrecta. Esto muestra que un tamaño de muestra grande no garantiza estimaciones precisas, como también lo señalaron los ajustes posteriores realizados por Lohr y Brick, que aún no resolvieron completamente el problema.</p>
<p>Para enfrentar sesgos similares, los investigadores de mercado y los encuestadores desarrollaron métodos de muestreo por cuotas. Este método controla las características demográficas de los entrevistados, como sexo, edad o estado laboral, con el fin de garantizar que la muestra sea representativa de esos grupos. Aunque el muestreo por cuotas tiene la ventaja de ser más barato y rápido que el muestreo probabilístico, también se basa en la suposición de que los no respondedores dentro de cada grupo son sustituidos aleatoriamente, lo que puede generar sesgos si no se maneja adecuadamente. Aunque algunos estudios han encontrado que los resultados de las muestras por cuotas son similares a los de las probabilísticas, esto no siempre ocurre, lo que resalta la limitación de este enfoque.</p>
</section>
<section id="pseudo-probability-sample-designs-for-hard-to-survey-populations" class="level2">
<h2 class="anchored" data-anchor-id="pseudo-probability-sample-designs-for-hard-to-survey-populations">Pseudo-Probability Sample Designs for “Hard-to-Survey Populations”</h2>
<p>En los últimos años, ha habido un aumento significativo en el uso de métodos de encuestas sociales para estudiar las características de poblaciones difíciles de encuestar, que son pequeños segmentos de la población general sin un marco de muestreo separado. Este tipo de población incluye grupos sensibles, como niños de 1 año para encuestas de vacunación o personas cuya pertenencia a ciertos grupos es confidencial. Para estos casos, se han desarrollado varios diseños de muestreo. Un ejemplo común es el <strong>método de muestreo del Programa Ampliado de Inmunización (EPI) de la OMS</strong>, que emplea un diseño de muestreo de dos etapas en comunidades seleccionadas al azar, sin necesidad de listar hogares. Este método se ha utilizado ampliamente en países en desarrollo para medir la inmunización infantil.</p>
<p>Otros métodos incluyen el <strong>muestreo basado en lugares</strong>, que se utiliza para muestrear poblaciones difíciles de encuestar que frecuentan ciertos lugares, como las poblaciones nómadas o aquellas cuyo estatus es sensible. Este método requiere la construcción de un marco de lugares y la selección de muestras de ubicación y períodos de tiempo para la recolección de datos. Finalmente, el <strong>muestreo dirigido por los propios encuestados (Respondent Driven Sampling - RDS)</strong> es una técnica que se basa en las redes sociales de los miembros de la población, utilizada para muestrear poblaciones ocultas como usuarios de drogas inyectables o trabajadores sexuales. Aunque el RDS puede generar una muestra de probabilidad en circunstancias ideales, en la práctica, es difícil garantizar que se cumplan todas las condiciones necesarias para obtener una muestra representativa.</p>
</section>
<section id="internet-surveys" class="level2">
<h2 class="anchored" data-anchor-id="internet-surveys">Internet Surveys</h2>
<p>El selección de muestras a través de internet es un enfoque relativamente reciente para realizar investigaciones sociales, que ha ganado gran popularidad debido a la posibilidad de obtener respuestas de grandes muestras a bajo costo y con alta velocidad. Sin embargo, los métodos de muestreo no probabilísticos que se utilizan en este tipo de encuestas generan preocupaciones sobre posibles sesgos en las estimaciones de los resultados. Las personas sin acceso a internet, o con acceso limitado, quedan excluidas de estos estudios, lo que hace que los participantes no sean una muestra representativa de la población general.</p>
<p>Un tipo de muestreo por internet es el muestreo en río, en el que se colocan invitaciones para participar en encuestas en varios sitios web, generalmente ofreciendo alguna forma de compensación. Este proceso de selección introduce <strong>sesgos que cuestionan la representatividad de la muestra</strong>, además de plantear dudas sobre la sinceridad y reflexión de las respuestas. Otro enfoque es el de los paneles de internet opt-in, donde personas son seleccionadas para participar en encuestas a lo largo del tiempo a cambio de un pago. Aunque estas encuestas no probabilísticas han sido mejoradas con métodos de ponderación y ajustes complejos, persisten las dudas sobre la representatividad de las respuestas y sobre si los datos externos utilizados para calibrar las muestras pueden reflejar con precisión a la población general.</p>
</section>
<section id="model-dependent-inference" class="level2">
<h2 class="anchored" data-anchor-id="model-dependent-inference">Model-Dependent Inference</h2>
<p>La inferencia dependiente del modelo ha ganado relevancia en el ámbito de las encuestas sociales, especialmente para abordar imperfecciones en el muestreo, como la no cobertura y la no respuesta. En particular, los <strong>enfoques basados en modelos</strong> se han vuelto necesarios para realizar análisis en subgrupos cuando los tamaños muestrales no son suficientes para obtener estimadores precisos a partir de métodos de muestreo basados en el diseño. Sin embargo, la adopción de estos métodos ha generado debates, ya que los estadísticos que prefieren enfoques basados en el diseño consideran que los métodos dependientes del modelo pueden ser menos confiables, sobre todo si el modelo está mal especificado. A pesar de estas preocupaciones, los avances en los métodos de ajuste, como la estimación de pequeñas áreas, han permitido que estos enfoques se utilicen de manera más frecuente, especialmente cuando se requiere estimar parámetros en áreas geográficas específicas.</p>
<p>El enfoque dependiente del modelo se utiliza especialmente cuando se buscan estimaciones para subgrupos pequeños o áreas administrativas definidas geográficamente, donde las muestras son demasiado pequeñas para obtener resultados precisos mediante métodos de diseño tradicionales. Estos enfoques de predicción permiten hacer estimaciones cuando los datos de los marcos de muestreo son insuficientes o no están disponibles para toda la población objetivo. Aunque estas estimaciones basadas en modelos pueden reducir la varianza en comparación con los estimadores basados en el diseño, no están exentas de sesgos si los modelos no se ajustan correctamente. A pesar de ello, la creciente aceptación de métodos como la estimación de pequeñas áreas ha sido clave para su implementación exitosa en diversas áreas, especialmente en el contexto de encuestas sociales de gran escala.</p>
</section>
<section id="analytic-uses-of-survey-data" class="level2">
<h2 class="anchored" data-anchor-id="analytic-uses-of-survey-data">Analytic Uses of Survey Data</h2>
<p>En la década de 1970, con la expansión de la potencia de cómputo y el software, los datos de encuestas recolectados mediante diseños complejos comenzaron a utilizarse principalmente en análisis secundarios para estudiar relaciones entre variables, buscando conexiones causales. Inicialmente, la regresión múltiple fue la técnica principal, con un enfoque en la magnitud de los coeficientes de regresión. Algunos analistas argumentaban que el interés no era para la población finita específica, sino para estimar parámetros de una superpoblación más general, donde el diseño de la muestra se volvía irrelevante, a menos que los pesos y el agrupamiento fueran variables predictoras importantes.</p>
<p>Con el tiempo, el uso de regresión se amplió para incluir otros modelos y técnicas multivariadas como el análisis de datos categóricos, el modelado multinivel y los análisis longitudinales. Estas técnicas han sido aplicadas a datos de encuestas complejas, permitiendo una mayor flexibilidad en el análisis de diversas relaciones entre variables, aunque su aplicación con datos complejos requiere enfoques especializados.</p>
</section>
<section id="administrative-records-and-big-data" class="level2">
<h2 class="anchored" data-anchor-id="administrative-records-and-big-data">Administrative Records and Big Data</h2>
<p>En los últimos tiempos, <strong>ha aumentado el interés en el uso de registros administrativos como una fuente alternativa de datos para la investigación</strong>. Esta alternativa ofrece ventajas notables en términos de costos y tamaño de muestra, pero también plantea importantes desafíos, como las cuestiones de privacidad y confidencialidad. A pesar de su atractivo, los registros administrativos tienen limitaciones, como la cobertura de los datos, la consistencia en la medición de las variables, y la validez de los datos a lo largo del tiempo. Además, muchas veces estos registros no contienen toda la información necesaria para los análisis, lo que puede requerir la vinculación de varios conjuntos de registros, un proceso que conlleva sus propios problemas de calidad y confidencialidad.</p>
<p>Además de los registros administrativos mantenidos por el gobierno, existen otras fuentes de datos para la investigación social, como los registros de organizaciones privadas. Sin embargo, estos también presentan problemas de calidad y acceso. Otra fuente de datos relevante es el “big data”, como el que se obtiene de la ubicación de los teléfonos móviles, que puede proporcionar información sobre los tiempos de viaje de los usuarios. A pesar de su atractivo, <strong>los grandes conjuntos de datos pueden ser engañosos</strong>, como se evidenció en el caso de Google Flu Trends, que inicialmente fue prometedor para predecir brotes de gripe, pero terminó fallando. Este tipo de ejemplos advierte sobre <strong>la necesidad de un análisis crítico al utilizar grandes volúmenes de datos</strong>.</p>
</section>
<section id="conclusiones" class="level2">
<h2 class="anchored" data-anchor-id="conclusiones">Conclusiones</h2>
<p>El debate entre muestreo probabilístico y muestreo no probabilístico fue crucial en los inicios de la investigación sobre encuestas. No fue hasta el trabajo de Neyman (1934) que el muestreo probabilístico se consolidó como el estándar para encuestas a gran escala. Este método garantiza que los resultados estén sujetos únicamente a errores de muestreo medibles, a diferencia del muestreo no probabilístico, donde siempre existe la duda sobre la representatividad de la muestra respecto a las variables de interés.</p>
<p>Aunque el muestreo probabilístico ofrece mayor rigor, implica mayores costos y tiempos, lo que ha llevado al desarrollo de métodos alternativos más accesibles para ciertas poblaciones. Hoy en día, se utilizan modelos que integran datos de distintas fuentes, como encuestas probabilísticas y no probabilísticas, registros administrativos y big data. Esto ha impulsado investigaciones sobre cómo combinar estas fuentes para realizar inferencias válidas y confiables.</p>
</section>
</section>
<section id="bibliografía" class="level1">
<h1>Bibliografía</h1>
<p>Kalton, G., 2023. Probability vs.&nbsp;Nonprobability Sampling: From the Birth of Survey Sampling to the Present Day. Statistics in Transition new series, 24(3), pp.&nbsp;1-22. <a href="https://doi.org/10.59170/stattrans-2023-029" class="uri">https://doi.org/10.59170/stattrans-2023-029</a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>